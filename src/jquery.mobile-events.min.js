(function(e){function h(){var e=i();if(e!==s){s=e;n.trigger("orientationchange")}}function b(t,n,r){var i=r.type;r.type=n;e.event.handle.call(t,r);r.type=i}var t={swipe_h_threshold:50,swipe_v_threshold:50,taphold_threshold:750,doubletap_int:500,touch_capable:"ontouchstart"in document.documentElement,orientation_support:"orientation"in window&&"onorientationchange"in window,startevent:"ontouchstart"in document.documentElement?"touchstart":"mousedown",endevent:"ontouchstart"in document.documentElement?"touchend":"mouseup",moveevent:"ontouchstart"in document.documentElement?"touchmove":"mousemove",tapevent:"ontouchstart"in document.documentElement?"tap":"click",scrollevent:"ontouchstart"in document.documentElement?"touchmove":"scroll",hold_timer:null,tap_timer:null};e.each("tapstart tapend tap singletap doubletap taphold swipe swipeup swiperight swipedown swipeleft scrollstart scrollend orientationchange".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)};e.attrFn[n]=true});e.event.special.tapstart={setup:function(){var n=this,r=e(n);r.bind(t.startevent,function(e){if(e.which&&e.which!==1){return false}else{b(n,"tapstart",e)}})}};e.event.special.tapend={setup:function(){var n=this,r=e(n);r.bind(t.endevent,function(e){b(n,"tapend",e)})}};e.event.special.taphold={setup:function(){var n=this,r=e(n),i,s,o={x:0,y:0};r.bind(t.startevent,function(e){if(e.which&&e.which!==1){return false}else{r.data("tapheld",false);i=e.target;o.x=t.touch_capabale?e.targetTouches[0].pageX:e.pageX;o.y=t.touch_capabale?e.targetTouches[0].pageY:e.pageY;t.hold_timer=window.setTimeout(function(){var s=t.touch_capabale?e.targetTouches[0].pageX:e.pageX,u=t.touch_capabale?e.targetTouches[0].pageY:e.pageY;if(e.target==i&&o.x==s&&o.y==u){r.data("tapheld",true);b(n,"taphold",e)}},t.taphold_threshold)}}).bind(t.endevent,function(){window.clearTimeout(t.hold_timer)})}};e.event.special.doubletap={setup:function(){var n=this,r=e(n),i,s;r.bind(t.startevent,function(e){if(e.which&&e.which!==1){return false}else{r.data("doubletapped",false);i=e.target}}).bind(t.endevent,function(e){var o=(new Date).getTime();var u=r.data("lastTouch")||o+1;var a=o-u;window.clearTimeout(s);if(a<t.doubletap_int&&a>0&&e.target==i&&a>100){r.data("doubletapped",true);window.clearTimeout(t.tap_timer);b(n,"doubletap",e)}else{r.data("lastTouch",o);s=window.setTimeout(function(e){window.clearTimeout(s)},t.doubletap_int,[e])}r.data("lastTouch",o)})}};e.event.special.singletap={setup:function(){var n=this,r=e(n),i=null,s=null;r.bind(t.startevent,function(e){if(e.which&&e.which!==1){return false}else{s=(new Date).getTime();i=e.target}}).bind(t.endevent,function(e){if(e.target==i){t.tap_timer=window.setTimeout(function(){if(!r.data("doubletapped")&&!r.data("tapheld")){b(n,"singletap",e)}},t.doubletap_int)}})}};e.event.special.tap={setup:function(){var n=this,r=e(n),i=false,s=null,o,u={x:0,y:0};r.bind(t.startevent,function(e){if(e.which&&e.which!==1){return false}else{i=true;u.x=t.touch_capabale?e.targetTouches[0].pageX:e.pageX;u.y=t.touch_capabale?e.targetTouches[0].pageY:e.pageY;o=(new Date).getTime();s=e.target}}).bind(t.endevent,function(e){var r=t.touch_capabale?e.targetTouches[0].pageX:e.pageX,a=t.touch_capabale?e.targetTouches[0].pageY:e.pageY;if(s==e.target&&i&&(new Date).getTime()-o<t.taphold_threshold&&u.x==r&&u.y==a){b(n,"tap",e)}})}};e.event.special.swipe={setup:function(){function o(e){i.x=t.touch_capable?e.targetTouches[0].pageX:e.pageX;i.y=t.touch_capable?e.targetTouches[0].pageY:e.pageY;s.x=i.x;s.y=i.y}function u(e){e.stopPropagation();s.x=t.touch_capable?e.targetTouches[0].pageX:e.pageX;s.y=t.touch_capable?e.targetTouches[0].pageY:e.pageY;window.clearTimeout(t.hold_timer);var n;var o=r.attr("data-xthreshold"),u=r.attr("data-ythreshold"),a=typeof o!=="undefined"&&o!==false&&parseInt(o)?parseInt(o):t.swipe_h_threshold,f=typeof u!=="undefined"&&u!==false&&parseInt(u)?parseInt(u):t.swipe_v_threshold;if(i.y>s.y&&i.y-s.y>f){n="swipeup"}if(i.x<s.x&&s.x-i.x>a){n="swiperight"}if(i.y<s.y&&s.y-i.y>f){n="swipedown"}if(i.x>s.x&&i.x-s.x>a){n="swipeleft"}if(n!=undefined){r.trigger("swipe").trigger(n)}}var n=this,r=e(n),i={x:0,y:0},s={x:0,y:0};if(!n.addEventListener){n.attachEvent(t.startevent,o);n.attachEvent(t.moveevent,u)}else{n.addEventListener(t.startevent,o,false);n.addEventListener(t.moveevent,u,false)}}};e.event.special.scrollstart={setup:function(){function o(e,t){i=t;b(n,i?"scrollstart":"scrollend",e)}var n=this,r=e(n),i,s;r.bind(t.scrollevent,function(e){if(!i){o(e,true)}clearTimeout(s);s=setTimeout(function(){o(e,false)},50)})}};var n=e(window),r,i,s,o,u,a={0:true,180:true};if(t.orientation_support){var f=window.innerWidth||e(window).width(),l=window.innerHeight||e(window).height(),c=50;o=f>l&&f-l>c;u=a[window.orientation];if(o&&u||!o&&!u){a={"-90":true,90:true}}}e.event.special.orientationchange=r={setup:function(){if(t.orientation_support){return false}s=i();n.bind("throttledresize",h)},teardown:function(){if(t.orientation_support){return false}n.unbind("throttledresize",h)},add:function(e){var t=e.handler;e.handler=function(e){e.orientation=i();return t.apply(this,arguments)}}};e.event.special.orientationchange.orientation=i=function(){var e=true,n=document.documentElement;if(t.orientation_support){e=a[window.orientation]}else{e=n&&n.clientWidth/n.clientHeight<1.1}return e?"portrait":"landscape"};e.event.special.throttledresize={setup:function(){e(this).bind("resize",d)},teardown:function(){e(this).unbind("resize",d)}};var p=250,d=function(){g=(new Date).getTime();y=g-v;if(y>=p){v=g;e(this).trigger("throttledresize")}else{if(m){window.clearTimeout(m)}m=window.setTimeout(h,p-y)}},v=0,m,g,y;e.each({scrollend:"scrollstart",swipeup:"swipe",swiperight:"swipe",swipedown:"swipe",swipeleft:"swipe"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)}}})})(jQuery)
